<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>åº”ç”¨å®‰è£…ä¸­å¿ƒ - Surge H5</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {
    background: #f5f5f7;
    margin: 0;
    padding: 0;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", Arial;
}
.container {
    padding: 20px;
}
.card {
    background: white;
    padding: 16px;
    border-radius: 12px;
    margin-bottom: 15px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.05);
}
input, button, select {
    width: 100%;
    padding: 12px;
    font-size: 16px;
    margin-top: 10px;
    border-radius: 8px;
    border: 1px solid #ccc;
}
button {
    background: #007aff;
    color: white;
    border: none;
}
button:active {
    opacity: 0.6;
}
.result {
    margin-top: 15px;
    padding: 10px;
    background: #eee;
    border-radius: 8px;
    font-size: 14px;
    white-space: pre-wrap;
    word-break: break-all;
}
.app-item {
    border-bottom: 1px solid #ddd;
    padding: 10px 0;
}
</style>
</head>
<body>
<div class="container">

<h2>åº”ç”¨å®‰è£…ä¸­å¿ƒ</h2>

<!-- ğŸ” 1. æœç´¢åº”ç”¨ -->
<div class="card">
    <h3>ğŸ” æœç´¢åº”ç”¨</h3>
    <input id="searchInput" placeholder="è¾“å…¥å…³é”®è¯ï¼Œä¾‹å¦‚ï¼šå¾®ä¿¡ã€æŠ–éŸ³">
    <button onclick="searchApp()">æœç´¢</button>
    <div id="searchResult" class="result"></div>
</div>

<!-- ğŸ“Œ 2. æŸ¥è¯¢ç‰ˆæœ¬ -->
<div class="card">
    <h3>ğŸ“Œ æŸ¥è¯¢åº”ç”¨ç‰ˆæœ¬</h3>
    <input id="bundleIdInput" placeholder="Bundle IDï¼Œä¾‹å¦‚ com.tencent.xin">
    <button onclick="queryVersion()">æŸ¥è¯¢ç‰ˆæœ¬</button>
    <div id="versionResult" class="result"></div>
</div>

<!-- ğŸ‘¤ 3. å·²è´­åˆ—è¡¨ -->
<div class="card">
    <h3>ğŸ‘¤ æŸ¥è¯¢å·²è´­åº”ç”¨</h3>
    <button onclick="purchasedList()">åŠ è½½å·²è´­åˆ—è¡¨</button>
    <div id="purchaseResult" class="result"></div>
</div>

<!-- ğŸ“¥ 4. ä¸‹è½½ IPA -->
<div class="card">
    <h3>ğŸ“¥ ä¸‹è½½ IPA</h3>
    <input id="downloadBundle" placeholder="Bundle ID">
    <input id="downloadVersion" placeholder="ç‰ˆæœ¬å·ï¼ˆå¯é€‰ï¼‰">
    <button onclick="downloadIPA()">ä¸‹è½½ IPA</button>
    <div id="downloadResult" class="result"></div>
</div>

<!-- ğŸ“² 5. å®‰è£… -->
<div class="card">
    <h3>ğŸ“² å®‰è£… IPA</h3>
    <input id="installUrl" placeholder="IPA ä¸‹è½½é“¾æ¥">
    <button onclick="install()">å®‰è£…</button>
    <div id="installResult" class="result"></div>
</div>

</div>

<script>
const API = "https://apple-api.com";
const INSTALL_API = "https://xiaobai.app";

async function request(url, method = "GET", data = null) {
    try {
        const opt = {
            method,
            headers: { "Content-Type": "application/json" }
        };
        if (data) opt.body = JSON.stringify(data);

        const res = await fetch(url, opt);
        return await res.json();
    } catch (e) {
        return { error: e.toString() };
    }
}

/* æœç´¢åº”ç”¨ */
async function searchApp() {
    const kw = document.getElementById("searchInput").value.trim();
    const res = await request(`${API}/store/search?q=${encodeURIComponent(kw)}`);
    document.getElementById("searchResult").innerText = JSON.stringify(res, null, 2);
}

/* æŸ¥è¯¢ç‰ˆæœ¬ */
async function queryVersion() {
    const bundleId = document.getElementById("bundleIdInput").value.trim();
    const res = await request(`${API}/version?bundleId=${bundleId}`);
    document.getElementById("versionResult").innerText = JSON.stringify(res, null, 2);
}

/* å·²è´­ */
async function purchasedList() {
    const res = await request(`${API}/store/purchased`);
    document.getElementById("purchaseResult").innerText = JSON.stringify(res, null, 2);
}

/* ä¸‹è½½ IPA */
async function downloadIPA() {
    const bundle = document.getElementById("downloadBundle").value.trim();
    const ver = document.getElementById("downloadVersion").value.trim();
    const url = `${API}/store/download?bundleId=${bundle}${ver ? "&version=" + ver : ""}`;
    const res = await request(url);
    document.getElementById("downloadResult").innerText = JSON.stringify(res, null, 2);
}

/* å®‰è£… IPA */
async function install() {
    const url = document.getElementById("installUrl").value.trim();
    const res = await request(`${INSTALL_API}/install?url=${encodeURIComponent(url)}`);
    document.getElementById("installResult").innerText = JSON.stringify(res, null, 2);
}
</script>
</body>
</html>